!function(t,i){"object"==typeof exports&&"undefined"!=typeof module?module.exports=i():"function"==typeof define&&define.amd?define(i):((t=t||self).nvpack=t.nvpack||{},t.nvpack.anal=i())}(this,function(){"use strict";class t{constructor(){this.document=window.document}set(t,i,n,s){var e=new Date((new Date).setHours(23,59,59,0));n=n||0==n?"expires="+n:"expires="+e,s=s?"domain=."+s:"",document.cookie=t+"="+i+"; "+n+"; "+s+"; path=/"}get(t){for(var i=t+"=",n=document.cookie.split(";"),s=0;s<n.length;s++){var e=n[s].trim();if(0==e.indexOf(i))return e.substring(i.length,e.length)}return null}remove(t){document.cookie=t+"=; Max-Age=-99999999;"}lsSupport(){return!!window.localStorage}setLS(t,i){return this.lsSupport()&&localStorage.setItem(t,i)}getLS(t){return this.lsSupport()?localStorage.getItem(t):null}duration(t){var i=1,n="Fri, 31 Dec 1999 23:59:59 GMT";if(t)if(501==t)n="Fri, 31 Dec 1999 23:59:59 GMT";else if(0==t)n=0;else{500==t?i=365:t>0&&t<=90&&(i=t);var s=new Date;1!=i&&(i-=1,s.setTime(s.getTime()+24*i*60*60*1e3)),s.setHours(23,59,59,0),n=s}return n}}var i=()=>{var t,i,n=window.document,s=0;return{get:function(o,r,c,h){var a=-1!==o.indexOf("?")?"&":"?";r=r||{};var u=e();for(i in u&&Array.isArray(u)&&u.length>0&&(r.cookieData=u.join(";")),notify_visitors&&notify_visitors.cookie_domain&&(r.cookieDomain=notify_visitors.cookie_domain),r)r.hasOwnProperty(i)&&(a+=encodeURIComponent(i)+"="+encodeURIComponent(r[i])+"&");var d=c+ ++s;return window[d]=function(t){h(t);try{delete window[d]}catch(t){}window[d]=null},function(i){var s=n.createElement("script"),e=!1;s.src=i,s.async=!0,s.onload=s.onreadystatechange=function(){e||this.readyState&&"loaded"!==this.readyState&&"complete"!==this.readyState||(e=!0,s.onload=s.onreadystatechange=null,s&&s.parentNode&&s.parentNode.removeChild(s))},!t&&(t=n.getElementsByTagName("head")[0]),t.appendChild(s)}(o+a+"js_callback="+d),d},post:function(t,i,n,s,e){e.ajax({url:t,type:"POST",data:i,contentType:!1,processData:!1,success:s})}}},n=()=>{return{bind:function(t,i,n,s){return s&&""!=s&&(window.notify_visitors.eventsRecord=window.notify_visitors.eventsRecord||{},window.notify_visitors.eventsRecord[s]=window.notify_visitors.eventsRecord[s]||[],window.notify_visitors.eventsRecord[s].push({n:i,e:t,c:n})),t.addEventListener?t.addEventListener(i,n):t.attachEvent?t.attachEvent("on"+i,n):void 0},unbind:function(t,i,n){return t.removeEventListener?t.removeEventListener(i,n):t.detachEvent?t.detachEvent("on"+i,n):void 0}}},s=()=>{return function(){if("function"==typeof window.CustomEvent)return!1;function t(t,i){i=i||{bubbles:!1,cancelable:!1,detail:null};var n=document.createEvent("CustomEvent");return n.initCustomEvent(t,i.bubbles,i.cancelable,i.detail),n}t.prototype=window.Event.prototype,window.CustomEvent=t}(),{send:function(t,i){var n=new CustomEvent("notifyvisitors_callback",{detail:{data:t,url:document.location.href,type:i}});window.dispatchEvent(n)}}},e=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],i=[];if(document&&document.cookie){var n=document.cookie.split(";");"all"===t&&(i=n),Array.isArray(t)&&n&&n.length>0&&(i=n.filter(function(i){var n=i.trim().split("=")[0];return!!t.includes(n)||0===n.indexOf("_nv_")}))}return i},o="https://analytics.notifyvisitors.com/",r={event:o+"brand/t1/event",user:o+"brand/t1/users",dimensions:o+"brand/t1/dimensions",userSessions:o+"brand/t1/userSessions",collectSessions:o+"brand/t1/collectSessions"},c=new Date;class h{constructor(e){this.response={},this.session=e.data&&e.data.session||"",this.set_NV_UID=e.data&&e.data.set_NV_UID||"",this.config=this.config||{},this.data=this.data||{},this.bindEvent=n(),this.callbackNotifyEvent=s(),this.getJSONP=i(),this.callbackName="nv_anal_json",this.productName="analytics",this.cookieController=new t,this.checkAuth(e.Events.data),this.nvHandler}checkAuth(t,i){this.response=t,null!=t.auth&&(null!=t.async&&!1!==t.async?handleWindowLoad():this.init())}handleWindowLoad(){"complete"==document.readyState?this.init():this.bindEvent.bind(window,"load",init,this.productName)}init(){if(nvpack.config=nvpack.config||{},nvpack.config.a)return!1;nvpack.config.a=!0,nvpack.callbackNotifyEvent=this.callbackNotifyEvent,this.config.urls=r,this.data.auth=this.response.auth||{},this.data.setting=this.response.auth||{},this.data.auth.ruleData&&(this.data.setting.ruleData=this.data.auth.ruleData=this.response.ruleData),this.response.tokens&&(this.data.setting.tokens=this.data.auth.tokens=this.response.tokens),this.data.setting.trafficSource=this.data.auth.trafficSource=document.referrer,this.data.setting.isPwa=window.matchMedia&&window.matchMedia("(display-mode: standalone)").matches?1:0,this.data.setting.pageUrl=this.data.auth.pageUrl=document.location,this.data.setting.gmOffset=this.data.auth.gmOffset=60*c.getTimezoneOffset()*-1,this.data.setting.screenWidth=this.data.auth.screenWidth=screen.width,this.data.setting.screenHeight=this.data.auth.screenHeight=screen.height,this.data.setting.storage=this.data.auth.storage=this.browserStorage(),this.data.setting.linkreferrer=this.data.auth.linkreferrer=document.referrer,this.callbackNotifyEvent.send("analytics_init","loadscript"),this.load()}load(){var t=this;if("fail"==this.response.Authentication)return!1;this.nvHandler=function(i){var n=Array.prototype.slice.call(i);t.performEventActions(n)},this.nvStaticEvent=function(){var i=t.response.event_integration;Object.keys(i).forEach(n=>{void 0!==i[n].event_initialize_type&&0!=i[n].event_initialize_type?this.callStaticEventonClick(i[n].event_initialize_type,i[n].event,i[n].attributes,i[n].ltv,i[n].scope):t.eventAction(i[n].event,i[n].attributes,i[n].ltv,i[n].scope,1)})},t.response.event_integration&&this.nvStaticEvent()}callStaticEventonClick(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",e=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"",o=this;if(i)var r=setInterval(function(){var c;if("X-Path"===t.type){if(!document.evaluate)return clearInterval(r),0;c=document.evaluate(t.value,document,null,XPathResult.FIRST_ORDERED_NODE_TYPE,null).singleNodeValue}else c="css"===t.type?document.querySelector(t.value):document.querySelector("#"+t.value);null!==c&&(clearInterval(r),c.addEventListener("click",function(){o.eventAction(i,n,s,e,1)}))},500)}performEventActions(t){if(!t[0])return!1;switch(t[0]){case"user":this.userAction(t[1],t[2]);break;case"pushuser":this.cookieController.get("_nv_push_subscribe")&&this.userAction(t[1],t[2]);break;case"event":this.eventAction(t[1],t[2],t[3],t[4]);break;case"pushevent":this.pusheventAction(t[1],t[2],t[3],t[4]);break;case"pushsubscribe":this.data.pushsubscribe.userID=t[1],this.data.pushsubscribe.event=t[2]}}userAction(t,i){if(t){var n=Object.assign({},this.data.setting);n.userID=t,n.userParams=i?JSON.stringify(i):"",this.getJSONP.get(this.config.urls.user,n,this.callbackName,this.userActionResponse.bind(this))}}userActionResponse(t){t&&"object"==typeof t&&(t.campaignCookie&&this.session&&this.session(t.campaignCookie),t.nv_uid&&this.set_NV_UID&&this.set_NV_UID(t.nv_uid)),"object"==typeof t&&"success"==t.Authentication&&t.userID&&this.response.userID!=t.userID&&(this.response.userID=t.userID,this.updateUserIdPushSubscribe(t)),t.callback_data&&this.callbackNotifyEvent.send(t.callback_data,"user")}updateUserIdPushSubscribe(t){t.campaignCookie.newSess&&1==t.campaignCookie.newSess&&window.notify_visitors.po&&window.notify_visitors.po.updateUserIdSubscription&&window.notify_visitors.po.updateUserIdSubscription(t.userID)}pusheventAction(t,i,n,s){this.cookieController.get("nv_push_subscribe")&&eventAction(t,i,n,s)}eventAction(t,i,n,s,e){if(t){var o=Object.assign({},this.data.setting);o.event_name=t,i&&(o.attributes=JSON.stringify(i)),n&&(o.ltv=n),s&&(o.scope=s),e&&(o.event_type=e),void 0!==this.data.pushsubscribe&&this.data.pushsubscribe.hasOwnProperty("userID")&&(o.userID=this.data.pushsubscribe.userID),this.getJSONP.get(this.config.urls.event,o,this.callbackName,this.eventActionResponse.bind(this))}}eventActionResponse(t){t.campaignCookie&&this.session&&this.session(t.campaignCookie),t.callback_data&&this.callbackNotifyEvent.send(t.callback_data,"event")}browserStorage(){var t={session:this.storage("sessionStorage"),local:this.storage("localStorage")};return JSON.stringify(t)}storage(t){var i={};return window[t]&&window[t].length>0&&Object.keys(window[t]).forEach(function(n){-1!==n.indexOf("_nv_")&&(i[n]=window[t][n])}),i}}var a=new h(window.notify_visitors);return h.nvHandler=a.nvHandler,h});
